<!DOCTYPE html>
<!-- Generated by pkgdown: do not edit by hand --><html lang="en">
<head>
<meta http-equiv="Content-Type" content="text/html; charset=UTF-8">
<meta charset="utf-8">
<meta http-equiv="X-UA-Compatible" content="IE=edge">
<meta name="viewport" content="width=device-width, initial-scale=1.0">
<title>`moderndive`: Datasets and functions for `tidyverse`-friendly introductory linear regression • moderndive</title>
<!-- jquery --><script src="https://cdnjs.cloudflare.com/ajax/libs/jquery/3.7.1/jquery.min.js" integrity="sha512-v2CJ7UaYy4JwqLDIrZUI/4hqeoQieOmAZNXBeQyjo21dadnwR+8ZaIJVT8EE2iyI61OV8e6M8PP2/4hpQINQ/g==" crossorigin="anonymous" referrerpolicy="no-referrer"></script><!-- Bootstrap --><link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/twitter-bootstrap/3.4.1/css/bootstrap.min.css" integrity="sha256-bZLfwXAP04zRMK2BjiO8iu9pf4FbLqX6zitd+tIvLhE=" crossorigin="anonymous">
<script src="https://cdnjs.cloudflare.com/ajax/libs/twitter-bootstrap/3.4.1/js/bootstrap.min.js" integrity="sha256-nuL8/2cJ5NDSSwnKD8VqreErSWHtnEP9E7AySL+1ev4=" crossorigin="anonymous"></script><!-- bootstrap-toc --><link rel="stylesheet" href="../bootstrap-toc.css">
<script src="../bootstrap-toc.js"></script><!-- Font Awesome icons --><link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/5.12.1/css/all.min.css" integrity="sha256-mmgLkCYLUQbXn0B1SRqzHar6dCnv9oZFPEC1g1cwlkk=" crossorigin="anonymous">
<link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/5.12.1/css/v4-shims.min.css" integrity="sha256-wZjR52fzng1pJHwx4aV2AO3yyTOXrcDW7jBpJtTwVxw=" crossorigin="anonymous">
<!-- clipboard.js --><script src="https://cdnjs.cloudflare.com/ajax/libs/clipboard.js/2.0.6/clipboard.min.js" integrity="sha256-inc5kl9MA1hkeYUt+EC3BhlIgyp/2jDIyBLS6k3UxPI=" crossorigin="anonymous"></script><!-- headroom.js --><script src="https://cdnjs.cloudflare.com/ajax/libs/headroom/0.11.0/headroom.min.js" integrity="sha256-AsUX4SJE1+yuDu5+mAVzJbuYNPHj/WroHuZ8Ir/CkE0=" crossorigin="anonymous"></script><script src="https://cdnjs.cloudflare.com/ajax/libs/headroom/0.11.0/jQuery.headroom.min.js" integrity="sha256-ZX/yNShbjqsohH1k95liqY9Gd8uOiE1S4vZc+9KQ1K4=" crossorigin="anonymous"></script><!-- pkgdown --><link href="../pkgdown.css" rel="stylesheet">
<script src="../pkgdown.js"></script><meta property="og:title" content="`moderndive`: Datasets and functions for `tidyverse`-friendly introductory linear regression">
<!-- mathjax --><script src="https://cdnjs.cloudflare.com/ajax/libs/mathjax/2.7.5/MathJax.js" integrity="sha256-nvJJv9wWKEm88qvoQl9ekL2J+k/RWIsaSScxxlsrv8k=" crossorigin="anonymous"></script><script src="https://cdnjs.cloudflare.com/ajax/libs/mathjax/2.7.5/config/TeX-AMS-MML_HTMLorMML.js" integrity="sha256-84DKXVJXs0/F8OTMzX4UR909+jtl4G7SPypPavF+GfA=" crossorigin="anonymous"></script><!--[if lt IE 9]>
<script src="https://oss.maxcdn.com/html5shiv/3.7.3/html5shiv.min.js"></script>
<script src="https://oss.maxcdn.com/respond/1.4.2/respond.min.js"></script>
<![endif]-->
</head>
<body data-spy="scroll" data-target="#toc">


    <div class="container template-article">
      <header><div class="navbar navbar-default navbar-fixed-top" role="navigation">
  <div class="container">
    <div class="navbar-header">
      <button type="button" class="navbar-toggle collapsed" data-toggle="collapse" data-target="#navbar" aria-expanded="false">
        <span class="sr-only">Toggle navigation</span>
        <span class="icon-bar"></span>
        <span class="icon-bar"></span>
        <span class="icon-bar"></span>
      </button>
      <span class="navbar-brand">
        <a class="navbar-link" href="../index.html">moderndive</a>
        <span class="version label label-default" data-toggle="tooltip" data-placement="bottom" title="">0.6.1.9000</span>
      </span>
    </div>

    <div id="navbar" class="navbar-collapse collapse">
      <ul class="nav navbar-nav">
<li>
  <a href="../articles/moderndive.html">Get started</a>
</li>
<li>
  <a href="../reference/index.html">Reference</a>
</li>
<li class="dropdown">
  <a href="#" class="dropdown-toggle" data-toggle="dropdown" role="button" data-bs-toggle="dropdown" aria-expanded="false">
    Articles

    <span class="caret"></span>
  </a>
  <ul class="dropdown-menu" role="menu">
<li>
      <a href="../articles/paper.html">Take a `moderndive` into introductory linear regression with R</a>
    </li>
  </ul>
</li>
<li>
  <a href="../news/index.html">Changelog</a>
</li>
      </ul>
<ul class="nav navbar-nav navbar-right">
<li>
  <a href="https://github.com/moderndive/moderndive/" class="external-link">
    <span class="fab fa-github fa-lg"></span>

  </a>
</li>
      </ul>
</div>
<!--/.nav-collapse -->
  </div>
<!--/.container -->
</div>
<!--/.navbar -->



      </header><div class="row">
  <div class="col-md-9 contents">
    <div class="page-header toc-ignore">
      <h1 data-toc-skip>
<code>moderndive</code>: Datasets and functions
for <code>tidyverse</code>-friendly introductory linear regression</h1>
                        <h4 data-toc-skip class="author">Albert Y. Kim,
Chester Ismay, and Max Kuhn</h4>
            
            <h4 data-toc-skip class="date">2024-07-08</h4>
      
      <small class="dont-index">Source: <a href="https://github.com/moderndive/moderndive/blob/master/vignettes/moderndive.Rmd" class="external-link"><code>vignettes/moderndive.Rmd</code></a></small>
      <div class="hidden name"><code>moderndive.Rmd</code></div>

    </div>

    
    
<div class="section level2">
<h2 id="summary">Summary<a class="anchor" aria-label="anchor" href="#summary"></a>
</h2>
<p>We present the <a href="https://moderndive.github.io/moderndive/" target="_blank"><code>moderndive</code></a> R package of datasets and
functions for <a href="https://www.tidyverse.org/" class="external-link">tidyverse</a>-friendly introductory
linear regression <span class="citation">(Wickham, Averick, et al.
2019)</span>. These tools leverage the well-developed
<code>tidyverse</code> and <code>broom</code> packages to facilitate 1)
working with regression tables that include confidence intervals, 2)
accessing regression outputs on an observation level
(e.g. fitted/predicted values and residuals), 3) inspecting scalar
summaries of regression fit
(e.g. <math display="inline" xmlns="http://www.w3.org/1998/Math/MathML"><semantics><msup><mi>R</mi><mn>2</mn></msup><annotation encoding="application/x-tex">R^2</annotation></semantics></math>,
<math display="inline" xmlns="http://www.w3.org/1998/Math/MathML"><semantics><msubsup><mi>R</mi><mrow><mi>a</mi><mi>d</mi><mi>j</mi></mrow><mn>2</mn></msubsup><annotation encoding="application/x-tex">R^2_{adj}</annotation></semantics></math>,
and mean squared error), and 4) visualizing parallel slopes regression
models using <code>ggplot2</code>-like syntax <span class="citation">(Wickham, Chang, et al. 2019; Robinson and Hayes
2019)</span>. This R package is designed to supplement the book
“Statistical Inference via Data Science: A ModernDive into R and the
Tidyverse” <span class="citation">(Ismay and Kim 2019)</span>. Note that
the book is also available online at <a href="https://moderndive.com" class="external-link uri">https://moderndive.com</a> and is referred to as
“ModernDive” for short.</p>
</div>
<div class="section level2">
<h2 id="statement-of-need">Statement of Need<a class="anchor" aria-label="anchor" href="#statement-of-need"></a>
</h2>
<p>Linear regression has long been a staple of introductory statistics
courses. While the curricula of introductory statistics courses has much
evolved of late, the overall importance of regression remains the same
<span class="citation">(American Statistical Association Undergraduate
Guidelines Workgroup 2016)</span>. Furthermore, while the use of the R
statistical programming language for statistical analysis is not new,
recent developments such as the <code>tidyverse</code> suite of packages
have made statistical computation with R accessible to a broader
audience <span class="citation">(Wickham, Averick, et al. 2019)</span>.
We go one step further by leveraging the <code>tidyverse</code> and the
<code>broom</code> packages to make linear regression accessible to
students taking an introductory statistics course <span class="citation">(Robinson and Hayes 2019)</span>. Such students are
likely to be new to statistical computation with R; we designed
<code>moderndive</code> with these students in mind.</p>
</div>
<div class="section level2">
<h2 id="introduction">Introduction<a class="anchor" aria-label="anchor" href="#introduction"></a>
</h2>
<p>Let’s load all the R packages we are going to need.</p>
<div class="sourceCode" id="cb1"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="kw"><a href="https://rdrr.io/r/base/library.html" class="external-link">library</a></span><span class="op">(</span><span class="va"><a href="https://moderndive.github.io/moderndive/">moderndive</a></span><span class="op">)</span></span>
<span><span class="kw"><a href="https://rdrr.io/r/base/library.html" class="external-link">library</a></span><span class="op">(</span><span class="va"><a href="https://ggplot2.tidyverse.org" class="external-link">ggplot2</a></span><span class="op">)</span></span>
<span><span class="kw"><a href="https://rdrr.io/r/base/library.html" class="external-link">library</a></span><span class="op">(</span><span class="va"><a href="https://dplyr.tidyverse.org" class="external-link">dplyr</a></span><span class="op">)</span></span>
<span><span class="kw"><a href="https://rdrr.io/r/base/library.html" class="external-link">library</a></span><span class="op">(</span><span class="va"><a href="https://yihui.org/knitr/" class="external-link">knitr</a></span><span class="op">)</span></span>
<span><span class="kw"><a href="https://rdrr.io/r/base/library.html" class="external-link">library</a></span><span class="op">(</span><span class="va"><a href="https://broom.tidymodels.org/" class="external-link">broom</a></span><span class="op">)</span></span></code></pre></div>
<p>Let’s consider data gathered from end of semester student evaluations
for a sample of 463 courses taught by 94 professors from the University
of Texas at Austin <span class="citation">(Diez, Barr, and
Çetinkaya-Rundel 2015)</span>. This data is included in the
<code>evals</code> data frame from the <code>moderndive</code>
package.</p>
<p>In the following table, we present a subset of 9 of the 14 variables
included for a random sample of 5 courses<a href="#fn1" class="footnote-ref" id="fnref1"><sup>1</sup></a>:</p>
<ol style="list-style-type: decimal">
<li>
<code>ID</code> uniquely identifies the course whereas
<code>prof_ID</code> identifies the professor who taught this course.
This distinction is important since many professors taught more than one
course.</li>
<li>
<code>score</code> is the outcome variable of interest: average
professor evaluation score out of 5 as given by the students in this
course.</li>
<li>The remaining variables are demographic variables describing that
course’s instructor, including <code>bty_avg</code> (average “beauty”
score) for that professor as given by a panel of 6 students.<a href="#fn2" class="footnote-ref" id="fnref2"><sup>2</sup></a>
</li>
</ol>
<table class="table">
<colgroup>
<col width="5%">
<col width="11%">
<col width="8%">
<col width="5%">
<col width="11%">
<col width="10%">
<col width="19%">
<col width="13%">
<col width="11%">
</colgroup>
<thead><tr class="header">
<th align="right">ID</th>
<th align="right">prof_ID</th>
<th align="right">score</th>
<th align="right">age</th>
<th align="right">bty_avg</th>
<th align="left">gender</th>
<th align="left">ethnicity</th>
<th align="left">language</th>
<th align="left">rank</th>
</tr></thead>
<tbody>
<tr class="odd">
<td align="right">129</td>
<td align="right">23</td>
<td align="right">3.7</td>
<td align="right">62</td>
<td align="right">3.000</td>
<td align="left">male</td>
<td align="left">not minority</td>
<td align="left">english</td>
<td align="left">tenured</td>
</tr>
<tr class="even">
<td align="right">109</td>
<td align="right">19</td>
<td align="right">4.7</td>
<td align="right">46</td>
<td align="right">4.333</td>
<td align="left">female</td>
<td align="left">not minority</td>
<td align="left">english</td>
<td align="left">tenured</td>
</tr>
<tr class="odd">
<td align="right">28</td>
<td align="right">6</td>
<td align="right">4.8</td>
<td align="right">62</td>
<td align="right">5.500</td>
<td align="left">male</td>
<td align="left">not minority</td>
<td align="left">english</td>
<td align="left">tenured</td>
</tr>
<tr class="even">
<td align="right">434</td>
<td align="right">88</td>
<td align="right">2.8</td>
<td align="right">62</td>
<td align="right">2.000</td>
<td align="left">male</td>
<td align="left">not minority</td>
<td align="left">english</td>
<td align="left">tenured</td>
</tr>
<tr class="odd">
<td align="right">330</td>
<td align="right">66</td>
<td align="right">4.0</td>
<td align="right">64</td>
<td align="right">2.333</td>
<td align="left">male</td>
<td align="left">not minority</td>
<td align="left">english</td>
<td align="left">tenured</td>
</tr>
</tbody>
</table>
<div class="section level3">
<h3 id="regression-analysis-the-good-old-fashioned-way">Regression analysis the “good old-fashioned” way<a class="anchor" aria-label="anchor" href="#regression-analysis-the-good-old-fashioned-way"></a>
</h3>
<p>Let’s fit a simple linear regression model of teaching
<code>score</code> as a function of instructor <code>age</code> using
the <code><a href="https://rdrr.io/r/stats/lm.html" class="external-link">lm()</a></code> function.</p>
<div class="sourceCode" id="cb2"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="va">score_model</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/stats/lm.html" class="external-link">lm</a></span><span class="op">(</span><span class="va">score</span> <span class="op">~</span> <span class="va">age</span>, data <span class="op">=</span> <span class="va">evals</span><span class="op">)</span></span></code></pre></div>
<p>Let’s now study the output of the fitted model
<code>score_model</code> “the good old-fashioned way”: using
<code><a href="https://rdrr.io/r/base/summary.html" class="external-link">summary()</a></code> which calls <code><a href="https://rdrr.io/r/stats/summary.lm.html" class="external-link">summary.lm()</a></code> behind the
scenes (we’ll refer to them interchangeably throughout this paper).</p>
<div class="sourceCode" id="cb3"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="fu"><a href="https://rdrr.io/r/base/summary.html" class="external-link">summary</a></span><span class="op">(</span><span class="va">score_model</span><span class="op">)</span></span>
<span><span class="co">## </span></span>
<span><span class="co">## Call:</span></span>
<span><span class="co">## lm(formula = score ~ age, data = evals)</span></span>
<span><span class="co">## </span></span>
<span><span class="co">## Residuals:</span></span>
<span><span class="co">##     Min      1Q  Median      3Q     Max </span></span>
<span><span class="co">## -1.9185 -0.3531  0.1172  0.4172  0.8825 </span></span>
<span><span class="co">## </span></span>
<span><span class="co">## Coefficients:</span></span>
<span><span class="co">##              Estimate Std. Error t value Pr(&gt;|t|)    </span></span>
<span><span class="co">## (Intercept)  4.461932   0.126778  35.195   &lt;2e-16 ***</span></span>
<span><span class="co">## age         -0.005938   0.002569  -2.311   0.0213 *  </span></span>
<span><span class="co">## ---</span></span>
<span><span class="co">## Signif. codes:  0 '***' 0.001 '**' 0.01 '*' 0.05 '.' 0.1 ' ' 1</span></span>
<span><span class="co">## </span></span>
<span><span class="co">## Residual standard error: 0.5413 on 461 degrees of freedom</span></span>
<span><span class="co">## Multiple R-squared:  0.01146,    Adjusted R-squared:  0.009311 </span></span>
<span><span class="co">## F-statistic: 5.342 on 1 and 461 DF,  p-value: 0.02125</span></span></code></pre></div>
<p>Here are 5 common student questions we’ve heard over the years in our
introductory statistics courses based on this output:</p>
<ol style="list-style-type: decimal">
<li>“Wow! Look at those p-value stars! Stars are good, so I should try
to get many stars, right?”</li>
<li>“How do we extract the values in the regression table?”</li>
<li>“Where are the fitted/predicted values and residuals?”</li>
<li>“How do I apply this model to a new set of data to make
predictions?”</li>
<li>“What is all this other stuff at the bottom?”</li>
</ol>
</div>
<div class="section level3">
<h3 id="regression-analysis-using-moderndive">Regression analysis using <code>moderndive</code><a class="anchor" aria-label="anchor" href="#regression-analysis-using-moderndive"></a>
</h3>
<p>To address these questions, we’ve included three functions in the
<code>moderndive</code> package that take a fitted model object as input
and return the same information as <code><a href="https://rdrr.io/r/stats/summary.lm.html" class="external-link">summary.lm()</a></code>, but output
them in tidyverse-friendly format <span class="citation">(Wickham,
Averick, et al. 2019)</span>. As we’ll see later, while these three
functions are thin wrappers to existing functions in the
<code>broom</code> package for converting statistical objects into tidy
tibbles, we modified them with the introductory statistics student in
mind <span class="citation">(Robinson and Hayes 2019)</span>.</p>
<ol style="list-style-type: decimal">
<li>
<p>Get a tidy regression table <strong>with confidence
intervals</strong>:</p>
<div class="sourceCode" id="cb4"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="fu"><a href="../reference/get_regression_table.html">get_regression_table</a></span><span class="op">(</span><span class="va">score_model</span><span class="op">)</span></span>
<span><span class="co">## <span style="color: #949494;"># A tibble: 2 × 7</span></span></span>
<span><span class="co">##   term      estimate std_error statistic p_value lower_ci upper_ci</span></span>
<span><span class="co">##   <span style="color: #949494; font-style: italic;">&lt;chr&gt;</span>        <span style="color: #949494; font-style: italic;">&lt;dbl&gt;</span>     <span style="color: #949494; font-style: italic;">&lt;dbl&gt;</span>     <span style="color: #949494; font-style: italic;">&lt;dbl&gt;</span>   <span style="color: #949494; font-style: italic;">&lt;dbl&gt;</span>    <span style="color: #949494; font-style: italic;">&lt;dbl&gt;</span>    <span style="color: #949494; font-style: italic;">&lt;dbl&gt;</span></span></span>
<span><span class="co">## <span style="color: #BCBCBC;">1</span> intercept    4.46      0.127     35.2    0        4.21     4.71 </span></span>
<span><span class="co">## <span style="color: #BCBCBC;">2</span> age         -<span style="color: #BB0000;">0.006</span>     0.003     -<span style="color: #BB0000;">2.31</span>   0.021   -<span style="color: #BB0000;">0.011</span>   -<span style="color: #BB0000;">0.001</span></span></span></code></pre></div>
</li>
<li>
<p>Get information on each point/observation in your regression,
including fitted/predicted values and residuals, in a single data
frame:</p>
<div class="sourceCode" id="cb5"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="fu"><a href="../reference/get_regression_points.html">get_regression_points</a></span><span class="op">(</span><span class="va">score_model</span><span class="op">)</span></span>
<span><span class="co">## <span style="color: #949494;"># A tibble: 463 × 5</span></span></span>
<span><span class="co">##       ID score   age score_hat residual</span></span>
<span><span class="co">##    <span style="color: #949494; font-style: italic;">&lt;int&gt;</span> <span style="color: #949494; font-style: italic;">&lt;dbl&gt;</span> <span style="color: #949494; font-style: italic;">&lt;int&gt;</span>     <span style="color: #949494; font-style: italic;">&lt;dbl&gt;</span>    <span style="color: #949494; font-style: italic;">&lt;dbl&gt;</span></span></span>
<span><span class="co">## <span style="color: #BCBCBC;"> 1</span>     1   4.7    36      4.25    0.452</span></span>
<span><span class="co">## <span style="color: #BCBCBC;"> 2</span>     2   4.1    36      4.25   -<span style="color: #BB0000;">0.148</span></span></span>
<span><span class="co">## <span style="color: #BCBCBC;"> 3</span>     3   3.9    36      4.25   -<span style="color: #BB0000;">0.348</span></span></span>
<span><span class="co">## <span style="color: #BCBCBC;"> 4</span>     4   4.8    36      4.25    0.552</span></span>
<span><span class="co">## <span style="color: #BCBCBC;"> 5</span>     5   4.6    59      4.11    0.488</span></span>
<span><span class="co">## <span style="color: #BCBCBC;"> 6</span>     6   4.3    59      4.11    0.188</span></span>
<span><span class="co">## <span style="color: #BCBCBC;"> 7</span>     7   2.8    59      4.11   -<span style="color: #BB0000;">1.31</span> </span></span>
<span><span class="co">## <span style="color: #BCBCBC;"> 8</span>     8   4.1    51      4.16   -<span style="color: #BB0000;">0.059</span></span></span>
<span><span class="co">## <span style="color: #BCBCBC;"> 9</span>     9   3.4    51      4.16   -<span style="color: #BB0000;">0.759</span></span></span>
<span><span class="co">## <span style="color: #BCBCBC;">10</span>    10   4.5    40      4.22    0.276</span></span>
<span><span class="co">## <span style="color: #949494;"># ℹ 453 more rows</span></span></span></code></pre></div>
</li>
<li>
<p>Get scalar summaries of a regression fit including
<math display="inline" xmlns="http://www.w3.org/1998/Math/MathML"><semantics><msup><mi>R</mi><mn>2</mn></msup><annotation encoding="application/x-tex">R^2</annotation></semantics></math>
and
<math display="inline" xmlns="http://www.w3.org/1998/Math/MathML"><semantics><msubsup><mi>R</mi><mrow><mi>a</mi><mi>d</mi><mi>j</mi></mrow><mn>2</mn></msubsup><annotation encoding="application/x-tex">R^2_{adj}</annotation></semantics></math>
but also the (root) mean-squared error:</p>
<div class="sourceCode" id="cb6"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="fu"><a href="../reference/get_regression_summaries.html">get_regression_summaries</a></span><span class="op">(</span><span class="va">score_model</span><span class="op">)</span></span>
<span><span class="co">## <span style="color: #949494;"># A tibble: 1 × 9</span></span></span>
<span><span class="co">##   r_squared adj_r_squared   mse  rmse sigma statistic p_value    df</span></span>
<span><span class="co">##       <span style="color: #949494; font-style: italic;">&lt;dbl&gt;</span>         <span style="color: #949494; font-style: italic;">&lt;dbl&gt;</span> <span style="color: #949494; font-style: italic;">&lt;dbl&gt;</span> <span style="color: #949494; font-style: italic;">&lt;dbl&gt;</span> <span style="color: #949494; font-style: italic;">&lt;dbl&gt;</span>     <span style="color: #949494; font-style: italic;">&lt;dbl&gt;</span>   <span style="color: #949494; font-style: italic;">&lt;dbl&gt;</span> <span style="color: #949494; font-style: italic;">&lt;dbl&gt;</span></span></span>
<span><span class="co">## <span style="color: #BCBCBC;">1</span>     0.011         0.009 0.292 0.540 0.541      5.34   0.021     1</span></span>
<span><span class="co">## <span style="color: #949494;"># ℹ 1 more variable: nobs &lt;dbl&gt;</span></span></span></code></pre></div>
</li>
</ol>
</div>
<div class="section level3">
<h3 id="bonus-visualizing-parallel-slopes-models-with-moderndive">Bonus: Visualizing parallel slopes models with
<code>moderndive</code><a class="anchor" aria-label="anchor" href="#bonus-visualizing-parallel-slopes-models-with-moderndive"></a>
</h3>
<p>Furthermore, say you would like to create a visualization of the
relationship between two numerical variables and a third categorical
variable with
<math display="inline" xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mi>k</mi><annotation encoding="application/x-tex">k</annotation></semantics></math>
levels. Let’s create this using a colored scatterplot via the
<code>ggplot2</code> package for data visualization <span class="citation">(Wickham, Chang, et al. 2019)</span>. Using
<code>geom_smooth(method = "lm", se = FALSE)</code> yields a
visualization of an <em>interaction model</em> where each of the
<math display="inline" xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mi>k</mi><annotation encoding="application/x-tex">k</annotation></semantics></math>
regression lines has their own intercept and slope. For example in , we
extend our previous regression model by now mapping the categorical
variable <code>ethnicity</code> to the <code>color</code> aesthetic.</p>
<div class="sourceCode" id="cb7"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="co"># Code to visualize interaction model:</span></span>
<span><span class="fu"><a href="https://ggplot2.tidyverse.org/reference/ggplot.html" class="external-link">ggplot</a></span><span class="op">(</span><span class="va">evals</span>, <span class="fu"><a href="https://ggplot2.tidyverse.org/reference/aes.html" class="external-link">aes</a></span><span class="op">(</span>x <span class="op">=</span> <span class="va">age</span>, y <span class="op">=</span> <span class="va">score</span>, color <span class="op">=</span> <span class="va">ethnicity</span><span class="op">)</span><span class="op">)</span> <span class="op">+</span></span>
<span>  <span class="fu"><a href="https://ggplot2.tidyverse.org/reference/geom_point.html" class="external-link">geom_point</a></span><span class="op">(</span><span class="op">)</span> <span class="op">+</span></span>
<span>  <span class="fu"><a href="https://ggplot2.tidyverse.org/reference/geom_smooth.html" class="external-link">geom_smooth</a></span><span class="op">(</span>method <span class="op">=</span> <span class="st">"lm"</span>, se <span class="op">=</span> <span class="cn">FALSE</span><span class="op">)</span> <span class="op">+</span></span>
<span>  <span class="fu"><a href="https://ggplot2.tidyverse.org/reference/labs.html" class="external-link">labs</a></span><span class="op">(</span>x <span class="op">=</span> <span class="st">"Age"</span>, y <span class="op">=</span> <span class="st">"Teaching score"</span>, color <span class="op">=</span> <span class="st">"Ethnicity"</span><span class="op">)</span></span></code></pre></div>
<div class="figure" style="text-align: center">
<img src="moderndive_files/figure-html/interaction-model-1.png" alt="Visualization of interaction model." width="100%"><p class="caption">
Visualization of interaction model.
</p>
</div>
<p>However, many introductory statistics courses start with the easier
to teach “common slope, different intercepts” regression model, also
known as the <em>parallel slopes</em> model. However, no argument to
plot such models exists within <code><a href="https://ggplot2.tidyverse.org/reference/geom_smooth.html" class="external-link">geom_smooth()</a></code>.</p>
<p><a href="https://github.com/echasnovski" target="_blank" class="external-link">Evgeni
Chasnovski</a> thus wrote a custom <code>geom_</code> extension to
<code>ggplot2</code> called <code><a href="../reference/geom_parallel_slopes.html">geom_parallel_slopes()</a></code>; this
extension is included in the <code>moderndive</code> package. Much like
<code><a href="https://ggplot2.tidyverse.org/reference/geom_smooth.html" class="external-link">geom_smooth()</a></code> from the <code>ggplot2</code> package, you
add <code><a href="../reference/geom_parallel_slopes.html">geom_parallel_slopes()</a></code> as a layer to the code,
resulting in .</p>
<div class="sourceCode" id="cb8"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="co"># Code to visualize parallel slopes model:</span></span>
<span><span class="fu"><a href="https://ggplot2.tidyverse.org/reference/ggplot.html" class="external-link">ggplot</a></span><span class="op">(</span><span class="va">evals</span>, <span class="fu"><a href="https://ggplot2.tidyverse.org/reference/aes.html" class="external-link">aes</a></span><span class="op">(</span>x <span class="op">=</span> <span class="va">age</span>, y <span class="op">=</span> <span class="va">score</span>, color <span class="op">=</span> <span class="va">ethnicity</span><span class="op">)</span><span class="op">)</span> <span class="op">+</span></span>
<span>  <span class="fu"><a href="https://ggplot2.tidyverse.org/reference/geom_point.html" class="external-link">geom_point</a></span><span class="op">(</span><span class="op">)</span> <span class="op">+</span></span>
<span>  <span class="fu"><a href="../reference/geom_parallel_slopes.html">geom_parallel_slopes</a></span><span class="op">(</span>se <span class="op">=</span> <span class="cn">FALSE</span><span class="op">)</span> <span class="op">+</span></span>
<span>  <span class="fu"><a href="https://ggplot2.tidyverse.org/reference/labs.html" class="external-link">labs</a></span><span class="op">(</span>x <span class="op">=</span> <span class="st">"Age"</span>, y <span class="op">=</span> <span class="st">"Teaching score"</span>, color <span class="op">=</span> <span class="st">"Ethnicity"</span><span class="op">)</span></span></code></pre></div>
<div class="figure" style="text-align: center">
<img src="moderndive_files/figure-html/parallel-slopes-model-1.png" alt="Visualization of parallel slopes model." width="100%"><p class="caption">
Visualization of parallel slopes model.
</p>
</div>
<p>At this point however, students will inevitably ask a sixth question:
“When would you ever use a parallel slopes model?”</p>
</div>
<div class="section level3">
<h3 id="why-should-you-use-the-moderndive-package">Why should you use the <code>moderndive</code> package?<a class="anchor" aria-label="anchor" href="#why-should-you-use-the-moderndive-package"></a>
</h3>
<p>To recap this introduction, we believe that the following functions
included in the <code>moderndive</code> package</p>
<ol style="list-style-type: decimal">
<li><code><a href="../reference/get_regression_table.html">get_regression_table()</a></code></li>
<li><code><a href="../reference/get_regression_points.html">get_regression_points()</a></code></li>
<li><code><a href="../reference/get_regression_summaries.html">get_regression_summaries()</a></code></li>
<li><code><a href="../reference/geom_parallel_slopes.html">geom_parallel_slopes()</a></code></li>
</ol>
<p>are effective pedagogical tools that can help address the six common
questions posed by students about introductory linear regression
performed in R. We now argue why.</p>
</div>
</div>
<div class="section level2">
<h2 id="features">Features<a class="anchor" aria-label="anchor" href="#features"></a>
</h2>
<div class="section level3">
<h3 id="less-p-value-stars-more-confidence-intervals">1. Less p-value stars, more confidence intervals<a class="anchor" aria-label="anchor" href="#less-p-value-stars-more-confidence-intervals"></a>
</h3>
<p>The first common student question:</p>
<blockquote>
<p>“Wow! Look at those p-value stars! Stars are good, so I should try to
get many stars, right?”</p>
</blockquote>
<p>We argue that the <code><a href="https://rdrr.io/r/stats/summary.lm.html" class="external-link">summary.lm()</a></code> output is deficient in an
introductory statistics setting because:</p>
<ol style="list-style-type: decimal">
<li>The
<code>Signif. codes:  0 '' 0.001 '**' 0.01 '*' 0.05 '.' 0.1 ' ' 1</code>
only encourage <strong>p-hacking</strong>. In case you have not yet been
convinced of the perniciousness of p-hacking, perhaps comedian <a href="https://www.youtube.com/watch?v=0Rnq1NpHdmw" target="_blank" class="external-link">John
Oliver can convince you</a>.<br>
</li>
<li>While not a silver bullet for eliminating misinterpretations of
statistical inference, confidence intervals present students with a
sense of the associated effect sizes of any explanatory variables. Thus,
practical as well as statistical significance is emphasized. These are
not included by default in the output of <code><a href="https://rdrr.io/r/stats/summary.lm.html" class="external-link">summary.lm()</a></code>.</li>
</ol>
<p>Instead of <code><a href="https://rdrr.io/r/base/summary.html" class="external-link">summary()</a></code>, let’s use the
<code><a href="../reference/get_regression_table.html">get_regression_table()</a></code> function:</p>
<div class="sourceCode" id="cb9"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="fu"><a href="../reference/get_regression_table.html">get_regression_table</a></span><span class="op">(</span><span class="va">score_model</span><span class="op">)</span></span>
<span><span class="co">## <span style="color: #949494;"># A tibble: 2 × 7</span></span></span>
<span><span class="co">##   term      estimate std_error statistic p_value lower_ci upper_ci</span></span>
<span><span class="co">##   <span style="color: #949494; font-style: italic;">&lt;chr&gt;</span>        <span style="color: #949494; font-style: italic;">&lt;dbl&gt;</span>     <span style="color: #949494; font-style: italic;">&lt;dbl&gt;</span>     <span style="color: #949494; font-style: italic;">&lt;dbl&gt;</span>   <span style="color: #949494; font-style: italic;">&lt;dbl&gt;</span>    <span style="color: #949494; font-style: italic;">&lt;dbl&gt;</span>    <span style="color: #949494; font-style: italic;">&lt;dbl&gt;</span></span></span>
<span><span class="co">## <span style="color: #BCBCBC;">1</span> intercept    4.46      0.127     35.2    0        4.21     4.71 </span></span>
<span><span class="co">## <span style="color: #BCBCBC;">2</span> age         -<span style="color: #BB0000;">0.006</span>     0.003     -<span style="color: #BB0000;">2.31</span>   0.021   -<span style="color: #BB0000;">0.011</span>   -<span style="color: #BB0000;">0.001</span></span></span></code></pre></div>
<p>Observe how the p-value stars are omitted and confidence intervals
for the point estimates of all regression parameters are included by
default. By including them in the output, we can then emphasize to
students that they “surround” the point estimates in the
<code>estimate</code> column. Note the confidence level is defaulted to
95%; this default can be changed using the <code>conf.level</code>
argument:</p>
<div class="sourceCode" id="cb10"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="fu"><a href="../reference/get_regression_table.html">get_regression_table</a></span><span class="op">(</span><span class="va">score_model</span>, conf.level <span class="op">=</span> <span class="fl">0.99</span><span class="op">)</span></span>
<span><span class="co">## <span style="color: #949494;"># A tibble: 2 × 7</span></span></span>
<span><span class="co">##   term      estimate std_error statistic p_value lower_ci upper_ci</span></span>
<span><span class="co">##   <span style="color: #949494; font-style: italic;">&lt;chr&gt;</span>        <span style="color: #949494; font-style: italic;">&lt;dbl&gt;</span>     <span style="color: #949494; font-style: italic;">&lt;dbl&gt;</span>     <span style="color: #949494; font-style: italic;">&lt;dbl&gt;</span>   <span style="color: #949494; font-style: italic;">&lt;dbl&gt;</span>    <span style="color: #949494; font-style: italic;">&lt;dbl&gt;</span>    <span style="color: #949494; font-style: italic;">&lt;dbl&gt;</span></span></span>
<span><span class="co">## <span style="color: #BCBCBC;">1</span> intercept    4.46      0.127     35.2    0        4.13     4.79 </span></span>
<span><span class="co">## <span style="color: #BCBCBC;">2</span> age         -<span style="color: #BB0000;">0.006</span>     0.003     -<span style="color: #BB0000;">2.31</span>   0.021   -<span style="color: #BB0000;">0.013</span>    0.001</span></span></code></pre></div>
</div>
<div class="section level3">
<h3 id="outputs-as-tibbles">2. Outputs as tibbles<a class="anchor" aria-label="anchor" href="#outputs-as-tibbles"></a>
</h3>
<p>The second common student question:</p>
<blockquote>
<p>“How do we extract the values in the regression table?”</p>
</blockquote>
<p>While one might argue that extracting the intercept and slope
coefficients can be “simply” done using
<code>coefficients(score_model)</code>, what about the standard errors?
For example, a Google query of “<em>how do I extract standard errors
from lm in R</em>” yielded results from <a href="https://stat.ethz.ch/pipermail/r-help/2008-April/160538.html" target="_blank" class="external-link">the R mailing list</a> and from <a href="https://stats.stackexchange.com/questions/27511/extract-standard-errors-of-coefficient-linear-regression-r" target="_blank" class="external-link">Cross Validated</a> suggesting we run:</p>
<div class="sourceCode" id="cb11"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="fu"><a href="https://rdrr.io/r/base/MathFun.html" class="external-link">sqrt</a></span><span class="op">(</span><span class="fu"><a href="https://rdrr.io/r/base/diag.html" class="external-link">diag</a></span><span class="op">(</span><span class="fu"><a href="https://rdrr.io/r/stats/vcov.html" class="external-link">vcov</a></span><span class="op">(</span><span class="va">score_model</span><span class="op">)</span><span class="op">)</span><span class="op">)</span></span>
<span><span class="co">## (Intercept)         age </span></span>
<span><span class="co">## 0.126778499 0.002569157</span></span></code></pre></div>
<p>We argue that this task shouldn’t be this hard, especially in an
introductory statistics setting. To rectify this, the three
<code>get_regression_*</code> functions all return data frames in the
tidyverse-style tibble (tidy table) format <span class="citation">(Müller and Wickham 2019)</span>. Therefore you can
extract columns using the <code><a href="https://dplyr.tidyverse.org/reference/pull.html" class="external-link">pull()</a></code> function from the
<code>dplyr</code> package <span class="citation">(Wickham et al.
2020)</span>:</p>
<div class="sourceCode" id="cb12"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="fu"><a href="../reference/get_regression_table.html">get_regression_table</a></span><span class="op">(</span><span class="va">score_model</span><span class="op">)</span> <span class="op"><a href="../reference/pipe.html">%&gt;%</a></span></span>
<span>  <span class="fu"><a href="https://dplyr.tidyverse.org/reference/pull.html" class="external-link">pull</a></span><span class="op">(</span><span class="va">std_error</span><span class="op">)</span></span>
<span><span class="co">## [1] 0.127 0.003</span></span></code></pre></div>
<p>or equivalently you can use the <code>$</code> sign operator from
base R:</p>
<div class="sourceCode" id="cb13"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="fu"><a href="../reference/get_regression_table.html">get_regression_table</a></span><span class="op">(</span><span class="va">score_model</span><span class="op">)</span><span class="op">$</span><span class="va">std_error</span></span>
<span><span class="co">## [1] 0.127 0.003</span></span></code></pre></div>
<p>Furthermore, by piping the above
<code>get_regression_table(score_model)</code> output into the
<code><a href="https://rdrr.io/pkg/knitr/man/kable.html" class="external-link">kable()</a></code> function from the <code>knitr</code> package <span class="citation">(Xie 2020)</span>, you can obtain aesthetically
pleasing regression tables in R Markdown documents, instead of tables
written in jarring computer output font:</p>
<div class="sourceCode" id="cb14"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="fu"><a href="../reference/get_regression_table.html">get_regression_table</a></span><span class="op">(</span><span class="va">score_model</span><span class="op">)</span> <span class="op"><a href="../reference/pipe.html">%&gt;%</a></span></span>
<span>  <span class="fu"><a href="https://rdrr.io/pkg/knitr/man/kable.html" class="external-link">kable</a></span><span class="op">(</span><span class="op">)</span></span></code></pre></div>
<table class="table">
<colgroup>
<col width="15%">
<col width="13%">
<col width="15%">
<col width="15%">
<col width="12%">
<col width="13%">
<col width="13%">
</colgroup>
<thead><tr class="header">
<th align="left">term</th>
<th align="right">estimate</th>
<th align="right">std_error</th>
<th align="right">statistic</th>
<th align="right">p_value</th>
<th align="right">lower_ci</th>
<th align="right">upper_ci</th>
</tr></thead>
<tbody>
<tr class="odd">
<td align="left">intercept</td>
<td align="right">4.462</td>
<td align="right">0.127</td>
<td align="right">35.195</td>
<td align="right">0.000</td>
<td align="right">4.213</td>
<td align="right">4.711</td>
</tr>
<tr class="even">
<td align="left">age</td>
<td align="right">-0.006</td>
<td align="right">0.003</td>
<td align="right">-2.311</td>
<td align="right">0.021</td>
<td align="right">-0.011</td>
<td align="right">-0.001</td>
</tr>
</tbody>
</table>
</div>
<div class="section level3">
<h3 id="birds-of-a-feather-should-flock-together-fitted-values-residuals">3. Birds of a feather should flock together: Fitted values &amp;
residuals<a class="anchor" aria-label="anchor" href="#birds-of-a-feather-should-flock-together-fitted-values-residuals"></a>
</h3>
<p>The third common student question:</p>
<blockquote>
<p>“Where are the fitted/predicted values and residuals?”</p>
</blockquote>
<p>How can we extract point-by-point information from a regression
model, such as the fitted/predicted values and the residuals? (Note we
only display the first 10 out of 463 of such values for brevity’s
sake.)</p>
<div class="sourceCode" id="cb15"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="fu"><a href="https://rdrr.io/r/stats/fitted.values.html" class="external-link">fitted</a></span><span class="op">(</span><span class="va">score_model</span><span class="op">)</span></span></code></pre></div>
<pre><code><span><span class="co">##        1        2        3        4        5        6        7 </span></span>
<span><span class="co">## 4.248156 4.248156 4.248156 4.248156 4.111577 4.111577 4.111577 </span></span>
<span><span class="co">##        8        9       10 </span></span>
<span><span class="co">## 4.159083 4.159083 4.224403</span></span></code></pre>
<div class="sourceCode" id="cb17"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="fu"><a href="https://rdrr.io/r/stats/residuals.html" class="external-link">residuals</a></span><span class="op">(</span><span class="va">score_model</span><span class="op">)</span></span></code></pre></div>
<pre><code><span><span class="co">##           1           2           3           4           5 </span></span>
<span><span class="co">##  0.45184376 -0.14815624 -0.34815624  0.55184376  0.48842294 </span></span>
<span><span class="co">##           6           7           8           9          10 </span></span>
<span><span class="co">##  0.18842294 -1.31157706 -0.05908286 -0.75908286  0.27559666</span></span></code></pre>
<p>But why have the original explanatory/predictor <code>age</code> and
outcome variable <code>score</code> in <code>evals</code>, the
fitted/predicted values <code>score_hat</code>, and
<code>residual</code> floating around in separate vectors? Since each
observation relates to the same course, we argue it makes more sense to
organize them together in the same data frame using
<code><a href="../reference/get_regression_points.html">get_regression_points()</a></code>:</p>
<div class="sourceCode" id="cb19"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="va">score_model_points</span> <span class="op">&lt;-</span> <span class="fu"><a href="../reference/get_regression_points.html">get_regression_points</a></span><span class="op">(</span><span class="va">score_model</span><span class="op">)</span></span>
<span><span class="va">score_model_points</span></span></code></pre></div>
<pre><code><span><span class="co">## <span style="color: #949494;"># A tibble: 10 × 5</span></span></span>
<span><span class="co">##       ID score   age score_hat residual</span></span>
<span><span class="co">##    <span style="color: #949494; font-style: italic;">&lt;int&gt;</span> <span style="color: #949494; font-style: italic;">&lt;dbl&gt;</span> <span style="color: #949494; font-style: italic;">&lt;int&gt;</span>     <span style="color: #949494; font-style: italic;">&lt;dbl&gt;</span>    <span style="color: #949494; font-style: italic;">&lt;dbl&gt;</span></span></span>
<span><span class="co">## <span style="color: #BCBCBC;"> 1</span>     1   4.7    36      4.25    0.452</span></span>
<span><span class="co">## <span style="color: #BCBCBC;"> 2</span>     2   4.1    36      4.25   -<span style="color: #BB0000;">0.148</span></span></span>
<span><span class="co">## <span style="color: #BCBCBC;"> 3</span>     3   3.9    36      4.25   -<span style="color: #BB0000;">0.348</span></span></span>
<span><span class="co">## <span style="color: #BCBCBC;"> 4</span>     4   4.8    36      4.25    0.552</span></span>
<span><span class="co">## <span style="color: #BCBCBC;"> 5</span>     5   4.6    59      4.11    0.488</span></span>
<span><span class="co">## <span style="color: #BCBCBC;"> 6</span>     6   4.3    59      4.11    0.188</span></span>
<span><span class="co">## <span style="color: #BCBCBC;"> 7</span>     7   2.8    59      4.11   -<span style="color: #BB0000;">1.31</span> </span></span>
<span><span class="co">## <span style="color: #BCBCBC;"> 8</span>     8   4.1    51      4.16   -<span style="color: #BB0000;">0.059</span></span></span>
<span><span class="co">## <span style="color: #BCBCBC;"> 9</span>     9   3.4    51      4.16   -<span style="color: #BB0000;">0.759</span></span></span>
<span><span class="co">## <span style="color: #BCBCBC;">10</span>    10   4.5    40      4.22    0.276</span></span></code></pre>
<p>Observe that the original outcome variable <code>score</code> and
explanatory/predictor variable <code>age</code> are now supplemented
with the fitted/predicted values <code>score_hat</code> and
<code>residual</code> columns. By putting the fitted values, predicted
values, and residuals next to the original data, we argue that the
computation of these values is less opaque. For example, instructors can
emphasize how all values in the first row of output are computed.</p>
<p>Furthermore, recall that since all outputs in the
<code>moderndive</code> package are tibble data frames, custom residual
analysis plots can be created instead of relying on the default plots
yielded by <code>plot.lm()</code>. For example, we can check for the
normality of residuals using the histogram of residuals shown in .</p>
<div class="sourceCode" id="cb21"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="co"># Code to visualize distribution of residuals:</span></span>
<span><span class="fu"><a href="https://ggplot2.tidyverse.org/reference/ggplot.html" class="external-link">ggplot</a></span><span class="op">(</span><span class="va">score_model_points</span>, <span class="fu"><a href="https://ggplot2.tidyverse.org/reference/aes.html" class="external-link">aes</a></span><span class="op">(</span>x <span class="op">=</span> <span class="va">residual</span><span class="op">)</span><span class="op">)</span> <span class="op">+</span></span>
<span>  <span class="fu"><a href="https://ggplot2.tidyverse.org/reference/geom_histogram.html" class="external-link">geom_histogram</a></span><span class="op">(</span>bins <span class="op">=</span> <span class="fl">20</span><span class="op">)</span> <span class="op">+</span></span>
<span>  <span class="fu"><a href="https://ggplot2.tidyverse.org/reference/labs.html" class="external-link">labs</a></span><span class="op">(</span>x <span class="op">=</span> <span class="st">"Residual"</span>, y <span class="op">=</span> <span class="st">"Count"</span><span class="op">)</span></span></code></pre></div>
<div class="figure" style="text-align: center">
<img src="moderndive_files/figure-html/residuals-1-1.png" alt="Histogram visualizing distribution of residuals." width="100%"><p class="caption">
Histogram visualizing distribution of residuals.
</p>
</div>
<p>As another example, we can investigate potential relationships
between the residuals and all explanatory/predictor variables and the
presence of heteroskedasticity using partial residual plots, like the
partial residual plot over age shown in . If the term
“heteroskedasticity” is new to you, it corresponds to the variability of
one variable being unequal across the range of values of another
variable. The presence of heteroskedasticity violates one of the
assumptions of inference for linear regression.</p>
<div class="sourceCode" id="cb22"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="co"># Code to visualize partial residual plot over age:</span></span>
<span><span class="fu"><a href="https://ggplot2.tidyverse.org/reference/ggplot.html" class="external-link">ggplot</a></span><span class="op">(</span><span class="va">score_model_points</span>, <span class="fu"><a href="https://ggplot2.tidyverse.org/reference/aes.html" class="external-link">aes</a></span><span class="op">(</span>x <span class="op">=</span> <span class="va">age</span>, y <span class="op">=</span> <span class="va">residual</span><span class="op">)</span><span class="op">)</span> <span class="op">+</span></span>
<span>  <span class="fu"><a href="https://ggplot2.tidyverse.org/reference/geom_point.html" class="external-link">geom_point</a></span><span class="op">(</span><span class="op">)</span> <span class="op">+</span></span>
<span>  <span class="fu"><a href="https://ggplot2.tidyverse.org/reference/labs.html" class="external-link">labs</a></span><span class="op">(</span>x <span class="op">=</span> <span class="st">"Age"</span>, y <span class="op">=</span> <span class="st">"Residual"</span><span class="op">)</span></span></code></pre></div>
<div class="figure" style="text-align: center">
<img src="moderndive_files/figure-html/residuals-2-1.png" alt="Partial residual residual plot over age." width="100%"><p class="caption">
Partial residual residual plot over age.
</p>
</div>
</div>
<div class="section level3">
<h3 id="a-quick-and-easy-kaggle-predictive-modeling-competition-submission">4. A quick-and-easy Kaggle predictive modeling competition
submission!<a class="anchor" aria-label="anchor" href="#a-quick-and-easy-kaggle-predictive-modeling-competition-submission"></a>
</h3>
<p>The fourth common student question:</p>
<blockquote>
<p>“How do I apply this model to a new set of data to make
predictions?”</p>
</blockquote>
<p>With the fields of machine learning and artificial intelligence
gaining prominence, the importance of predictive modeling cannot be
understated. Therefore, we’ve designed the
<code><a href="../reference/get_regression_points.html">get_regression_points()</a></code> function to allow for a
<code>newdata</code> argument to quickly apply a previously fitted model
to new observations.</p>
<p>Let’s create an artificial “new” dataset consisting of two
instructors of age 39 and 42 and save it in a tibble data frame called
<code>new_prof</code>. We then set the <code>newdata</code> argument to
<code><a href="../reference/get_regression_points.html">get_regression_points()</a></code> to apply our previously fitted
model <code>score_model</code> to this new data, where
<code>score_hat</code> holds the corresponding fitted/predicted
values.</p>
<div class="sourceCode" id="cb23"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="va">new_prof</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://tibble.tidyverse.org/reference/tibble.html" class="external-link">tibble</a></span><span class="op">(</span>age <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/c.html" class="external-link">c</a></span><span class="op">(</span><span class="fl">39</span>, <span class="fl">42</span><span class="op">)</span><span class="op">)</span></span>
<span><span class="fu"><a href="../reference/get_regression_points.html">get_regression_points</a></span><span class="op">(</span><span class="va">score_model</span>, newdata <span class="op">=</span> <span class="va">new_prof</span><span class="op">)</span></span>
<span><span class="co">## <span style="color: #949494;"># A tibble: 2 × 3</span></span></span>
<span><span class="co">##      ID   age score_hat</span></span>
<span><span class="co">##   <span style="color: #949494; font-style: italic;">&lt;int&gt;</span> <span style="color: #949494; font-style: italic;">&lt;dbl&gt;</span>     <span style="color: #949494; font-style: italic;">&lt;dbl&gt;</span></span></span>
<span><span class="co">## <span style="color: #BCBCBC;">1</span>     1    39      4.23</span></span>
<span><span class="co">## <span style="color: #BCBCBC;">2</span>     2    42      4.21</span></span></code></pre></div>
<p>Let’s do another example, this time using the Kaggle <a href="https://www.kaggle.com/c/house-prices-advanced-regression-techniques" target="_blank" class="external-link">House Prices: Advanced Regression Techniques</a>
practice competition ( displays the homepage for this competition).</p>
<div class="figure" style="text-align: center">
<img src="kaggle.jpeg" alt="House prices Kaggle competition homepage." width="95%"><p class="caption">
House prices Kaggle competition homepage.
</p>
</div>
<p>This Kaggle competition requires you to fit/train a model to the
provided <code>train.csv</code> training set to make predictions of
house prices in the provided <code>test.csv</code> test set. We present
an application of the <code><a href="../reference/get_regression_points.html">get_regression_points()</a></code> function
allowing students to participate in this Kaggle competition. It
will:</p>
<ol style="list-style-type: decimal">
<li>Read in the training and test data.</li>
<li>Fit a naive model of house sale price as a function of year sold to
the training data.</li>
<li>Make predictions on the test data and write them to a
<code>submission.csv</code> file that can be submitted to Kaggle using
<code><a href="../reference/get_regression_points.html">get_regression_points()</a></code>. Note the use of the
<code>ID</code> argument to use the <code>id</code> variable in
<code>test</code> to identify the rows (a requirement of Kaggle
competition submissions).</li>
</ol>
<div class="sourceCode" id="cb24"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="kw"><a href="https://rdrr.io/r/base/library.html" class="external-link">library</a></span><span class="op">(</span><span class="va"><a href="https://readr.tidyverse.org" class="external-link">readr</a></span><span class="op">)</span></span>
<span><span class="kw"><a href="https://rdrr.io/r/base/library.html" class="external-link">library</a></span><span class="op">(</span><span class="va"><a href="https://dplyr.tidyverse.org" class="external-link">dplyr</a></span><span class="op">)</span></span>
<span><span class="kw"><a href="https://rdrr.io/r/base/library.html" class="external-link">library</a></span><span class="op">(</span><span class="va"><a href="https://moderndive.github.io/moderndive/">moderndive</a></span><span class="op">)</span></span>
<span></span>
<span><span class="co"># Load in training and test set</span></span>
<span><span class="va">train</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://readr.tidyverse.org/reference/read_delim.html" class="external-link">read_csv</a></span><span class="op">(</span><span class="st">"https://moderndive.com/data/train.csv"</span><span class="op">)</span></span>
<span><span class="va">test</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://readr.tidyverse.org/reference/read_delim.html" class="external-link">read_csv</a></span><span class="op">(</span><span class="st">"https://moderndive.com/data/test.csv"</span><span class="op">)</span></span>
<span></span>
<span><span class="co"># Fit model:</span></span>
<span><span class="va">house_model</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/stats/lm.html" class="external-link">lm</a></span><span class="op">(</span><span class="va">SalePrice</span> <span class="op">~</span> <span class="va">YrSold</span>, data <span class="op">=</span> <span class="va">train</span><span class="op">)</span></span>
<span></span>
<span><span class="co"># Make predictions and save in appropriate data frame format:</span></span>
<span><span class="va">submission</span> <span class="op">&lt;-</span> <span class="va">house_model</span> <span class="op"><a href="../reference/pipe.html">%&gt;%</a></span></span>
<span>  <span class="fu"><a href="../reference/get_regression_points.html">get_regression_points</a></span><span class="op">(</span>newdata <span class="op">=</span> <span class="va">test</span>, ID <span class="op">=</span> <span class="st">"Id"</span><span class="op">)</span> <span class="op"><a href="../reference/pipe.html">%&gt;%</a></span></span>
<span>  <span class="fu"><a href="https://dplyr.tidyverse.org/reference/select.html" class="external-link">select</a></span><span class="op">(</span><span class="va">Id</span>, SalePrice <span class="op">=</span> <span class="va">SalePrice_hat</span><span class="op">)</span></span>
<span></span>
<span><span class="co"># Write predictions to csv:</span></span>
<span><span class="fu"><a href="https://readr.tidyverse.org/reference/write_delim.html" class="external-link">write_csv</a></span><span class="op">(</span><span class="va">submission</span>, <span class="st">"submission.csv"</span><span class="op">)</span></span></code></pre></div>
<p>After submitting <code>submission.csv</code> to the leaderboard for
this Kaggle competition, we obtain a “root mean squared logarithmic
error” (RMSLE) score of 0.42918 as seen in .</p>
<div class="figure" style="text-align: center">
<img src="leaderboard_orig.jpeg" alt="Resulting Kaggle RMSLE score." width="100%"><p class="caption">
Resulting Kaggle RMSLE score.
</p>
</div>
</div>
<div class="section level3">
<h3 id="scalar-summaries-of-linear-regression-model-fits">5. Scalar summaries of linear regression model fits<a class="anchor" aria-label="anchor" href="#scalar-summaries-of-linear-regression-model-fits"></a>
</h3>
<p>The fifth common student question:</p>
<blockquote>
<p>“What is all this other stuff at the bottom?”</p>
</blockquote>
<p>Recall the output of the standard <code><a href="https://rdrr.io/r/stats/summary.lm.html" class="external-link">summary.lm()</a></code> from
earlier:</p>
<pre><code><span><span class="co">## </span></span>
<span><span class="co">## Call:</span></span>
<span><span class="co">## lm(formula = score ~ age, data = evals)</span></span>
<span><span class="co">## </span></span>
<span><span class="co">## Residuals:</span></span>
<span><span class="co">##     Min      1Q  Median      3Q     Max </span></span>
<span><span class="co">## -1.9185 -0.3531  0.1172  0.4172  0.8825 </span></span>
<span><span class="co">## </span></span>
<span><span class="co">## Coefficients:</span></span>
<span><span class="co">##              Estimate Std. Error t value Pr(&gt;|t|)    </span></span>
<span><span class="co">## (Intercept)  4.461932   0.126778  35.195   &lt;2e-16 ***</span></span>
<span><span class="co">## age         -0.005938   0.002569  -2.311   0.0213 *  </span></span>
<span><span class="co">## ---</span></span>
<span><span class="co">## Signif. codes:  0 '***' 0.001 '**' 0.01 '*' 0.05 '.' 0.1 ' ' 1</span></span>
<span><span class="co">## </span></span>
<span><span class="co">## Residual standard error: 0.5413 on 461 degrees of freedom</span></span>
<span><span class="co">## Multiple R-squared:  0.01146,    Adjusted R-squared:  0.009311 </span></span>
<span><span class="co">## F-statistic: 5.342 on 1 and 461 DF,  p-value: 0.02125</span></span></code></pre>
<p>Say we wanted to extract the scalar model summaries at the bottom of
this output, such as
<math display="inline" xmlns="http://www.w3.org/1998/Math/MathML"><semantics><msup><mi>R</mi><mn>2</mn></msup><annotation encoding="application/x-tex">R^2</annotation></semantics></math>,
<math display="inline" xmlns="http://www.w3.org/1998/Math/MathML"><semantics><msubsup><mi>R</mi><mrow><mi>a</mi><mi>d</mi><mi>j</mi></mrow><mn>2</mn></msubsup><annotation encoding="application/x-tex">R^2_{adj}</annotation></semantics></math>,
and the
<math display="inline" xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mi>F</mi><annotation encoding="application/x-tex">F</annotation></semantics></math>-statistic.
We can do so using the <code><a href="../reference/get_regression_summaries.html">get_regression_summaries()</a></code>
function.</p>
<div class="sourceCode" id="cb26"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="fu"><a href="../reference/get_regression_summaries.html">get_regression_summaries</a></span><span class="op">(</span><span class="va">score_model</span><span class="op">)</span></span>
<span><span class="co">## <span style="color: #949494;"># A tibble: 1 × 9</span></span></span>
<span><span class="co">##   r_squared adj_r_squared   mse  rmse sigma statistic p_value    df</span></span>
<span><span class="co">##       <span style="color: #949494; font-style: italic;">&lt;dbl&gt;</span>         <span style="color: #949494; font-style: italic;">&lt;dbl&gt;</span> <span style="color: #949494; font-style: italic;">&lt;dbl&gt;</span> <span style="color: #949494; font-style: italic;">&lt;dbl&gt;</span> <span style="color: #949494; font-style: italic;">&lt;dbl&gt;</span>     <span style="color: #949494; font-style: italic;">&lt;dbl&gt;</span>   <span style="color: #949494; font-style: italic;">&lt;dbl&gt;</span> <span style="color: #949494; font-style: italic;">&lt;dbl&gt;</span></span></span>
<span><span class="co">## <span style="color: #BCBCBC;">1</span>     0.011         0.009 0.292 0.540 0.541      5.34   0.021     1</span></span>
<span><span class="co">## <span style="color: #949494;"># ℹ 1 more variable: nobs &lt;dbl&gt;</span></span></span></code></pre></div>
<p>We’ve supplemented the standard scalar summaries output yielded by
<code><a href="https://rdrr.io/r/base/summary.html" class="external-link">summary()</a></code> with the mean squared error <code>mse</code> and
root mean squared error <code>rmse</code> given their popularity in
machine learning settings.</p>
</div>
<div class="section level3">
<h3 id="plot-parallel-slopes-regression-models">6. Plot parallel slopes regression models<a class="anchor" aria-label="anchor" href="#plot-parallel-slopes-regression-models"></a>
</h3>
<p>Finally, the last common student question:</p>
<blockquote>
<p>“When would you ever use a parallel slopes model?”</p>
</blockquote>
<p>For example, recall the earlier visualizations of the interaction and
parallel slopes models for teaching score as a function of age and
ethnicity we saw in Figures and . Let’s present both visualizations
side-by-side in .</p>
<div class="figure" style="text-align: center">
<img src="moderndive_files/figure-html/interaction-and-parallel-slopes-model-1-1.png" alt="Interaction (left) and parallel slopes (right) models." width="100%"><p class="caption">
Interaction (left) and parallel slopes (right) models.
</p>
</div>
<p>Students might be wondering “Why would you use the parallel slopes
model on the right when the data clearly form an”X” pattern as seen in
the interaction model on the left?” This is an excellent opportunity to
gently introduce the notion of <em>model selection</em> and <em>Occam’s
Razor</em>: an interaction model should only be used over a parallel
slopes model <strong>if the additional complexity of the interaction
model is warranted</strong>. Here, we define model
“complexity/simplicity” in terms of the number of parameters in the
corresponding regression tables:</p>
<div class="sourceCode" id="cb27"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="co"># Regression table for interaction model:</span></span>
<span><span class="va">interaction_evals</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/stats/lm.html" class="external-link">lm</a></span><span class="op">(</span><span class="va">score</span> <span class="op">~</span> <span class="va">age</span> <span class="op">*</span> <span class="va">ethnicity</span>, data <span class="op">=</span> <span class="va">evals</span><span class="op">)</span></span>
<span><span class="fu"><a href="../reference/get_regression_table.html">get_regression_table</a></span><span class="op">(</span><span class="va">interaction_evals</span><span class="op">)</span></span>
<span><span class="co">## <span style="color: #949494;"># A tibble: 4 × 7</span></span></span>
<span><span class="co">##   term          estimate std_error statistic p_value lower_ci upper_ci</span></span>
<span><span class="co">##   <span style="color: #949494; font-style: italic;">&lt;chr&gt;</span>            <span style="color: #949494; font-style: italic;">&lt;dbl&gt;</span>     <span style="color: #949494; font-style: italic;">&lt;dbl&gt;</span>     <span style="color: #949494; font-style: italic;">&lt;dbl&gt;</span>   <span style="color: #949494; font-style: italic;">&lt;dbl&gt;</span>    <span style="color: #949494; font-style: italic;">&lt;dbl&gt;</span>    <span style="color: #949494; font-style: italic;">&lt;dbl&gt;</span></span></span>
<span><span class="co">## <span style="color: #BCBCBC;">1</span> intercept        2.61      0.518      5.04   0        1.59     3.63 </span></span>
<span><span class="co">## <span style="color: #BCBCBC;">2</span> age              0.032     0.011      2.84   0.005    0.01     0.054</span></span>
<span><span class="co">## <span style="color: #BCBCBC;">3</span> ethnicity: n…    2.00      0.534      3.74   0        0.945    3.04 </span></span>
<span><span class="co">## <span style="color: #BCBCBC;">4</span> age:ethnicit…   -<span style="color: #BB0000;">0.04</span>      0.012     -<span style="color: #BB0000;">3.51</span>   0       -<span style="color: #BB0000;">0.063</span>   -<span style="color: #BB0000;">0.018</span></span></span>
<span></span>
<span><span class="co"># Regression table for parallel slopes model:</span></span>
<span><span class="va">parallel_slopes_evals</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/stats/lm.html" class="external-link">lm</a></span><span class="op">(</span><span class="va">score</span> <span class="op">~</span> <span class="va">age</span> <span class="op">+</span> <span class="va">ethnicity</span>, data <span class="op">=</span> <span class="va">evals</span><span class="op">)</span></span>
<span><span class="fu"><a href="../reference/get_regression_table.html">get_regression_table</a></span><span class="op">(</span><span class="va">parallel_slopes_evals</span><span class="op">)</span></span>
<span><span class="co">## <span style="color: #949494;"># A tibble: 3 × 7</span></span></span>
<span><span class="co">##   term          estimate std_error statistic p_value lower_ci upper_ci</span></span>
<span><span class="co">##   <span style="color: #949494; font-style: italic;">&lt;chr&gt;</span>            <span style="color: #949494; font-style: italic;">&lt;dbl&gt;</span>     <span style="color: #949494; font-style: italic;">&lt;dbl&gt;</span>     <span style="color: #949494; font-style: italic;">&lt;dbl&gt;</span>   <span style="color: #949494; font-style: italic;">&lt;dbl&gt;</span>    <span style="color: #949494; font-style: italic;">&lt;dbl&gt;</span>    <span style="color: #949494; font-style: italic;">&lt;dbl&gt;</span></span></span>
<span><span class="co">## <span style="color: #BCBCBC;">1</span> intercept        4.37      0.136     32.1    0        4.1      4.63 </span></span>
<span><span class="co">## <span style="color: #BCBCBC;">2</span> age             -<span style="color: #BB0000;">0.006</span>     0.003     -<span style="color: #BB0000;">2.5</span>    0.013   -<span style="color: #BB0000;">0.012</span>   -<span style="color: #BB0000;">0.001</span></span></span>
<span><span class="co">## <span style="color: #BCBCBC;">3</span> ethnicity: n…    0.138     0.073      1.89   0.059   -<span style="color: #BB0000;">0.005</span>    0.282</span></span></code></pre></div>
<p>The interaction model is “more complex” as evidenced by its
regression table involving 4 rows of parameter estimates whereas the
parallel slopes model is “simpler” as evidenced by its regression table
involving only 3 parameter estimates. It can be argued however that this
additional complexity is warranted given the clearly different slopes in
the left-hand plot of .</p>
<p>We now present a contrasting example, this time from Chapter 6 of the
online version of <a href="https://moderndive.com/6-multiple-regression.html#model-selection" class="external-link">ModernDive
Subsection 6.3.1</a> involving Massachusetts USA public high schools.<a href="#fn3" class="footnote-ref" id="fnref3"><sup>3</sup></a> Let’s plot
both the interaction and parallel slopes models in .</p>
<div class="sourceCode" id="cb28"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="co"># Code to plot interaction and parallel slopes models for MA_schools</span></span>
<span><span class="fu"><a href="https://ggplot2.tidyverse.org/reference/ggplot.html" class="external-link">ggplot</a></span><span class="op">(</span></span>
<span>  <span class="va">MA_schools</span>,</span>
<span>  <span class="fu"><a href="https://ggplot2.tidyverse.org/reference/aes.html" class="external-link">aes</a></span><span class="op">(</span>x <span class="op">=</span> <span class="va">perc_disadvan</span>, y <span class="op">=</span> <span class="va">average_sat_math</span>, color <span class="op">=</span> <span class="va">size</span><span class="op">)</span></span>
<span><span class="op">)</span> <span class="op">+</span></span>
<span>  <span class="fu"><a href="https://ggplot2.tidyverse.org/reference/geom_point.html" class="external-link">geom_point</a></span><span class="op">(</span>alpha <span class="op">=</span> <span class="fl">0.25</span><span class="op">)</span> <span class="op">+</span></span>
<span>  <span class="fu"><a href="https://ggplot2.tidyverse.org/reference/labs.html" class="external-link">labs</a></span><span class="op">(</span></span>
<span>    x <span class="op">=</span> <span class="st">"% economically disadvantaged"</span>,</span>
<span>    y <span class="op">=</span> <span class="st">"Math SAT Score"</span>,</span>
<span>    color <span class="op">=</span> <span class="st">"School size"</span></span>
<span>  <span class="op">)</span> <span class="op">+</span></span>
<span>  <span class="fu"><a href="https://ggplot2.tidyverse.org/reference/geom_smooth.html" class="external-link">geom_smooth</a></span><span class="op">(</span>method <span class="op">=</span> <span class="st">"lm"</span>, se <span class="op">=</span> <span class="cn">FALSE</span><span class="op">)</span></span>
<span></span>
<span><span class="fu"><a href="https://ggplot2.tidyverse.org/reference/ggplot.html" class="external-link">ggplot</a></span><span class="op">(</span></span>
<span>  <span class="va">MA_schools</span>,</span>
<span>  <span class="fu"><a href="https://ggplot2.tidyverse.org/reference/aes.html" class="external-link">aes</a></span><span class="op">(</span>x <span class="op">=</span> <span class="va">perc_disadvan</span>, y <span class="op">=</span> <span class="va">average_sat_math</span>, color <span class="op">=</span> <span class="va">size</span><span class="op">)</span></span>
<span><span class="op">)</span> <span class="op">+</span></span>
<span>  <span class="fu"><a href="https://ggplot2.tidyverse.org/reference/geom_point.html" class="external-link">geom_point</a></span><span class="op">(</span>alpha <span class="op">=</span> <span class="fl">0.25</span><span class="op">)</span> <span class="op">+</span></span>
<span>  <span class="fu"><a href="https://ggplot2.tidyverse.org/reference/labs.html" class="external-link">labs</a></span><span class="op">(</span></span>
<span>    x <span class="op">=</span> <span class="st">"% economically disadvantaged"</span>,</span>
<span>    y <span class="op">=</span> <span class="st">"Math SAT Score"</span>,</span>
<span>    color <span class="op">=</span> <span class="st">"School size"</span></span>
<span>  <span class="op">)</span> <span class="op">+</span></span>
<span>  <span class="fu"><a href="../reference/geom_parallel_slopes.html">geom_parallel_slopes</a></span><span class="op">(</span>se <span class="op">=</span> <span class="cn">FALSE</span><span class="op">)</span></span></code></pre></div>
<div class="figure" style="text-align: center">
<img src="moderndive_files/figure-html/interaction-and-parallel-slopes-model-2-1.png" alt="Interaction (left) and parallel slopes (right) models." width="100%"><p class="caption">
Interaction (left) and parallel slopes (right) models.
</p>
</div>
<p>In terms of the corresponding regression tables, observe that the
corresponding regression table for the parallel slopes model has 4 rows
as opposed to the 6 for the interaction model, reflecting its higher
degree of “model simplicity.”</p>
<div class="sourceCode" id="cb29"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="co"># Regression table for interaction model:</span></span>
<span><span class="va">interaction_MA</span> <span class="op">&lt;-</span></span>
<span>  <span class="fu"><a href="https://rdrr.io/r/stats/lm.html" class="external-link">lm</a></span><span class="op">(</span><span class="va">average_sat_math</span> <span class="op">~</span> <span class="va">perc_disadvan</span> <span class="op">*</span> <span class="va">size</span>, data <span class="op">=</span> <span class="va">MA_schools</span><span class="op">)</span></span>
<span><span class="fu"><a href="../reference/get_regression_table.html">get_regression_table</a></span><span class="op">(</span><span class="va">interaction_MA</span><span class="op">)</span></span>
<span><span class="co">## <span style="color: #949494;"># A tibble: 6 × 7</span></span></span>
<span><span class="co">##   term          estimate std_error statistic p_value lower_ci upper_ci</span></span>
<span><span class="co">##   <span style="color: #949494; font-style: italic;">&lt;chr&gt;</span>            <span style="color: #949494; font-style: italic;">&lt;dbl&gt;</span>     <span style="color: #949494; font-style: italic;">&lt;dbl&gt;</span>     <span style="color: #949494; font-style: italic;">&lt;dbl&gt;</span>   <span style="color: #949494; font-style: italic;">&lt;dbl&gt;</span>    <span style="color: #949494; font-style: italic;">&lt;dbl&gt;</span>    <span style="color: #949494; font-style: italic;">&lt;dbl&gt;</span></span></span>
<span><span class="co">## <span style="color: #BCBCBC;">1</span> intercept      594.       13.3      44.7     0      568.     620.   </span></span>
<span><span class="co">## <span style="color: #BCBCBC;">2</span> perc_disadvan   -<span style="color: #BB0000;">2.93</span>      0.294    -<span style="color: #BB0000;">9.96</span>    0       -<span style="color: #BB0000;">3.51</span>    -<span style="color: #BB0000;">2.35</span> </span></span>
<span><span class="co">## <span style="color: #BCBCBC;">3</span> size: medium   -<span style="color: #BB0000;">17.8</span>      15.8      -<span style="color: #BB0000;">1.12</span>    0.263  -<span style="color: #BB0000;">48.9</span>     13.4  </span></span>
<span><span class="co">## <span style="color: #BCBCBC;">4</span> size: large    -<span style="color: #BB0000;">13.3</span>      13.8      -<span style="color: #BB0000;">0.962</span>   0.337  -<span style="color: #BB0000;">40.5</span>     13.9  </span></span>
<span><span class="co">## <span style="color: #BCBCBC;">5</span> perc_disadva…    0.146     0.371     0.393   0.694   -<span style="color: #BB0000;">0.585</span>    0.877</span></span>
<span><span class="co">## <span style="color: #BCBCBC;">6</span> perc_disadva…    0.189     0.323     0.586   0.559   -<span style="color: #BB0000;">0.446</span>    0.824</span></span>
<span></span>
<span><span class="co"># Regression table for parallel slopes model:</span></span>
<span><span class="va">parallel_slopes_MA</span> <span class="op">&lt;-</span></span>
<span>  <span class="fu"><a href="https://rdrr.io/r/stats/lm.html" class="external-link">lm</a></span><span class="op">(</span><span class="va">average_sat_math</span> <span class="op">~</span> <span class="va">perc_disadvan</span> <span class="op">+</span> <span class="va">size</span>, data <span class="op">=</span> <span class="va">MA_schools</span><span class="op">)</span></span>
<span><span class="fu"><a href="../reference/get_regression_table.html">get_regression_table</a></span><span class="op">(</span><span class="va">parallel_slopes_MA</span><span class="op">)</span></span>
<span><span class="co">## <span style="color: #949494;"># A tibble: 4 × 7</span></span></span>
<span><span class="co">##   term          estimate std_error statistic p_value lower_ci upper_ci</span></span>
<span><span class="co">##   <span style="color: #949494; font-style: italic;">&lt;chr&gt;</span>            <span style="color: #949494; font-style: italic;">&lt;dbl&gt;</span>     <span style="color: #949494; font-style: italic;">&lt;dbl&gt;</span>     <span style="color: #949494; font-style: italic;">&lt;dbl&gt;</span>   <span style="color: #949494; font-style: italic;">&lt;dbl&gt;</span>    <span style="color: #949494; font-style: italic;">&lt;dbl&gt;</span>    <span style="color: #949494; font-style: italic;">&lt;dbl&gt;</span></span></span>
<span><span class="co">## <span style="color: #BCBCBC;">1</span> intercept       588.       7.61     77.3     0       573.     603.  </span></span>
<span><span class="co">## <span style="color: #BCBCBC;">2</span> perc_disadvan    -<span style="color: #BB0000;">2.78</span>     0.106   -<span style="color: #BB0000;">26.1</span>     0        -<span style="color: #BB0000;">2.99</span>    -<span style="color: #BB0000;">2.57</span></span></span>
<span><span class="co">## <span style="color: #BCBCBC;">3</span> size: medium    -<span style="color: #BB0000;">11.9</span>      7.54     -<span style="color: #BB0000;">1.58</span>    0.115   -<span style="color: #BB0000;">26.7</span>      2.91</span></span>
<span><span class="co">## <span style="color: #BCBCBC;">4</span> size: large      -<span style="color: #BB0000;">6.36</span>     6.92     -<span style="color: #BB0000;">0.919</span>   0.359   -<span style="color: #BB0000;">20.0</span>      7.26</span></span></code></pre></div>
<p>Unlike our earlier comparison of interaction and parallel slopes
models in , in this case it could be argued that the additional
complexity of the interaction model is <em>not</em> warranted since the
3 three regression lines in the left-hand interaction are already
somewhat parallel. Therefore the simpler parallel slopes model should be
favored.</p>
<p>Going one step further, notice how the three regression lines in the
visualization of the parallel slopes model in the right-hand plot of
have similar intercepts. In can thus be argued that the additional model
complexity induced by introducing the categorical variable school
<code>size</code> is not warranted. Therefore, a simple linear
regression model using only <code>perc_disadvan</code> percent of the
student body that are economically disadvantaged should be favored.</p>
<p>While many students will inevitably find these results depressing, in
our opinion, it is important to additionally emphasize that such
regression analyses can be used as an empowering tool to bring to light
inequities in access to education and inform policy decisions.</p>
</div>
</div>
<div class="section level2">
<h2 id="the-details">The Details<a class="anchor" aria-label="anchor" href="#the-details"></a>
</h2>
<div class="section level3">
<h3 id="broom-wrappers">Three wrappers to <code>broom</code> functions<a class="anchor" aria-label="anchor" href="#broom-wrappers"></a>
</h3>
<p>As we mentioned earlier, the three <code>get_regression_*</code>
functions are wrappers of functions from the <code>broom</code> package
for converting statistical analysis objects into tidy tibbles along with
a few added tweaks, but with the introductory statistics student in mind
<span class="citation">(Robinson and Hayes 2019)</span>:</p>
<ol style="list-style-type: decimal">
<li>
<code><a href="../reference/get_regression_table.html">get_regression_table()</a></code> is a wrapper for
<code><a href="https://generics.r-lib.org/reference/tidy.html" class="external-link">broom::tidy()</a></code>.</li>
<li>
<code><a href="../reference/get_regression_points.html">get_regression_points()</a></code> is a wrapper for
<code><a href="https://generics.r-lib.org/reference/augment.html" class="external-link">broom::augment()</a></code>.</li>
<li>
<code>get_regression_summaries</code> is a wrapper for
<code><a href="https://generics.r-lib.org/reference/glance.html" class="external-link">broom::glance()</a></code>.</li>
</ol>
<p>Why did we take this approach to address the initial 5 common student
questions at the outset of the article?</p>
<ol style="list-style-type: decimal">
<li>By writing wrappers to pre-existing functions, instead of creating
new custom functions, there is minimal re-inventing of the wheel
necessary.</li>
<li>In our experience, novice R users had a hard time understanding the
<code>broom</code> package function names <code><a href="https://generics.r-lib.org/reference/tidy.html" class="external-link">tidy()</a></code>,
<code><a href="https://generics.r-lib.org/reference/augment.html" class="external-link">augment()</a></code>, and <code><a href="https://generics.r-lib.org/reference/glance.html" class="external-link">glance()</a></code>. To make them more
user-friendly, the <code>moderndive</code> package wrappers have much
more intuitively named <code><a href="../reference/get_regression_table.html">get_regression_table()</a></code>,
<code><a href="../reference/get_regression_points.html">get_regression_points()</a></code>, and
<code><a href="../reference/get_regression_summaries.html">get_regression_summaries()</a></code>.</li>
<li>The variables included in the outputs of the above 3
<code>broom</code> functions are not all applicable to an introductory
statistics students and of those that were, we found they were not
intuitive for new R users. We therefore cut out some of the variables
from the output and renamed some of the remaining variables. For
example, compare the outputs of the <code><a href="../reference/get_regression_points.html">get_regression_points()</a></code>
wrapper function and the parent <code><a href="https://generics.r-lib.org/reference/augment.html" class="external-link">broom::augment()</a></code>
function.</li>
</ol>
<div class="sourceCode" id="cb30"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="fu"><a href="../reference/get_regression_points.html">get_regression_points</a></span><span class="op">(</span><span class="va">score_model</span><span class="op">)</span></span>
<span><span class="co">## <span style="color: #949494;"># A tibble: 463 × 5</span></span></span>
<span><span class="co">##       ID score   age score_hat residual</span></span>
<span><span class="co">##    <span style="color: #949494; font-style: italic;">&lt;int&gt;</span> <span style="color: #949494; font-style: italic;">&lt;dbl&gt;</span> <span style="color: #949494; font-style: italic;">&lt;int&gt;</span>     <span style="color: #949494; font-style: italic;">&lt;dbl&gt;</span>    <span style="color: #949494; font-style: italic;">&lt;dbl&gt;</span></span></span>
<span><span class="co">## <span style="color: #BCBCBC;"> 1</span>     1   4.7    36      4.25    0.452</span></span>
<span><span class="co">## <span style="color: #BCBCBC;"> 2</span>     2   4.1    36      4.25   -<span style="color: #BB0000;">0.148</span></span></span>
<span><span class="co">## <span style="color: #BCBCBC;"> 3</span>     3   3.9    36      4.25   -<span style="color: #BB0000;">0.348</span></span></span>
<span><span class="co">## <span style="color: #BCBCBC;"> 4</span>     4   4.8    36      4.25    0.552</span></span>
<span><span class="co">## <span style="color: #BCBCBC;"> 5</span>     5   4.6    59      4.11    0.488</span></span>
<span><span class="co">## <span style="color: #BCBCBC;"> 6</span>     6   4.3    59      4.11    0.188</span></span>
<span><span class="co">## <span style="color: #BCBCBC;"> 7</span>     7   2.8    59      4.11   -<span style="color: #BB0000;">1.31</span> </span></span>
<span><span class="co">## <span style="color: #BCBCBC;"> 8</span>     8   4.1    51      4.16   -<span style="color: #BB0000;">0.059</span></span></span>
<span><span class="co">## <span style="color: #BCBCBC;"> 9</span>     9   3.4    51      4.16   -<span style="color: #BB0000;">0.759</span></span></span>
<span><span class="co">## <span style="color: #BCBCBC;">10</span>    10   4.5    40      4.22    0.276</span></span>
<span><span class="co">## <span style="color: #949494;"># ℹ 453 more rows</span></span></span>
<span><span class="fu">broom</span><span class="fu">::</span><span class="fu"><a href="https://generics.r-lib.org/reference/augment.html" class="external-link">augment</a></span><span class="op">(</span><span class="va">score_model</span><span class="op">)</span></span>
<span><span class="co">## <span style="color: #949494;"># A tibble: 463 × 8</span></span></span>
<span><span class="co">##    score   age .fitted  .resid    .hat .sigma   .cooksd .std.resid</span></span>
<span><span class="co">##    <span style="color: #949494; font-style: italic;">&lt;dbl&gt;</span> <span style="color: #949494; font-style: italic;">&lt;int&gt;</span>   <span style="color: #949494; font-style: italic;">&lt;dbl&gt;</span>   <span style="color: #949494; font-style: italic;">&lt;dbl&gt;</span>   <span style="color: #949494; font-style: italic;">&lt;dbl&gt;</span>  <span style="color: #949494; font-style: italic;">&lt;dbl&gt;</span>     <span style="color: #949494; font-style: italic;">&lt;dbl&gt;</span>      <span style="color: #949494; font-style: italic;">&lt;dbl&gt;</span></span></span>
<span><span class="co">## <span style="color: #BCBCBC;"> 1</span>   4.7    36    4.25  0.452  0.005<span style="text-decoration: underline;">60</span>  0.542 0.001<span style="text-decoration: underline;">97</span>        0.837</span></span>
<span><span class="co">## <span style="color: #BCBCBC;"> 2</span>   4.1    36    4.25 -<span style="color: #BB0000;">0.148</span>  0.005<span style="text-decoration: underline;">60</span>  0.542 0.000<span style="text-decoration: underline;">212</span>      -<span style="color: #BB0000;">0.274</span></span></span>
<span><span class="co">## <span style="color: #BCBCBC;"> 3</span>   3.9    36    4.25 -<span style="color: #BB0000;">0.348</span>  0.005<span style="text-decoration: underline;">60</span>  0.542 0.001<span style="text-decoration: underline;">17</span>       -<span style="color: #BB0000;">0.645</span></span></span>
<span><span class="co">## <span style="color: #BCBCBC;"> 4</span>   4.8    36    4.25  0.552  0.005<span style="text-decoration: underline;">60</span>  0.541 0.002<span style="text-decoration: underline;">94</span>        1.02 </span></span>
<span><span class="co">## <span style="color: #BCBCBC;"> 5</span>   4.6    59    4.11  0.488  0.004<span style="text-decoration: underline;">71</span>  0.541 0.001<span style="text-decoration: underline;">93</span>        0.904</span></span>
<span><span class="co">## <span style="color: #BCBCBC;"> 6</span>   4.3    59    4.11  0.188  0.004<span style="text-decoration: underline;">71</span>  0.542 0.000<span style="text-decoration: underline;">288</span>       0.349</span></span>
<span><span class="co">## <span style="color: #BCBCBC;"> 7</span>   2.8    59    4.11 -<span style="color: #BB0000;">1.31</span>   0.004<span style="text-decoration: underline;">71</span>  0.538 0.013<span style="text-decoration: underline;">9</span>        -<span style="color: #BB0000;">2.43</span> </span></span>
<span><span class="co">## <span style="color: #BCBCBC;"> 8</span>   4.1    51    4.16 -<span style="color: #BB0000;">0.059</span><span style="color: #BB0000; text-decoration: underline;">1</span> 0.002<span style="text-decoration: underline;">32</span>  0.542 0.000<span style="text-decoration: underline;">013</span>9     -<span style="color: #BB0000;">0.109</span></span></span>
<span><span class="co">## <span style="color: #BCBCBC;"> 9</span>   3.4    51    4.16 -<span style="color: #BB0000;">0.759</span>  0.002<span style="text-decoration: underline;">32</span>  0.541 0.002<span style="text-decoration: underline;">29</span>       -<span style="color: #BB0000;">1.40</span> </span></span>
<span><span class="co">## <span style="color: #BCBCBC;">10</span>   4.5    40    4.22  0.276  0.003<span style="text-decoration: underline;">74</span>  0.542 0.000<span style="text-decoration: underline;">488</span>       0.510</span></span>
<span><span class="co">## <span style="color: #949494;"># ℹ 453 more rows</span></span></span></code></pre></div>
<p>The source code for these three <code>get_regression_*</code>
functions can be found on <a href="https://github.com/moderndive/moderndive/blob/master/R/regression_functions.R" target="_blank" class="external-link">GitHub</a>.</p>
</div>
<div class="section level3">
<h3 id="custom-geometries">Custom geometries<a class="anchor" aria-label="anchor" href="#custom-geometries"></a>
</h3>
<p>The <code><a href="../reference/geom_parallel_slopes.html">geom_parallel_slopes()</a></code> is a custom built
<code>geom</code> extension to the <code>ggplot2</code> package. For
example, the <code>ggplot2</code> webpage page gives <a href="https://ggplot2.tidyverse.org/articles/extending-ggplot2.html" target="_blank" class="external-link">instructions</a> on how to create such extensions. The
source code for <code><a href="../reference/geom_parallel_slopes.html">geom_parallel_slopes()</a></code> written by <a href="https://github.com/echasnovski" target="_blank" class="external-link">Evgeni
Chasnovski</a> can be found on <a href="https://github.com/moderndive/moderndive/blob/master/R/geom_parallel_slopes.R" target="_blank" class="external-link">GitHub</a>.</p>
</div>
</div>
<div class="section level2">
<h2 id="author-contributions">Author contributions<a class="anchor" aria-label="anchor" href="#author-contributions"></a>
</h2>
<p>Albert Y. Kim and Chester Ismay contributed equally to the
development of the <code>moderndive</code> package. Albert Y. Kim wrote
a majority of the initial version of this manuscript with Chester Ismay
writing the rest. Max Kuhn provided guidance and feedback at various
stages of the package development and manuscript writing.</p>
</div>
<div class="section level2">
<h2 id="acknowledgments">Acknowledgments<a class="anchor" aria-label="anchor" href="#acknowledgments"></a>
</h2>
<p>Many thanks to Jenny Smetzer <a href="https://github.com/smetzer180" target="_blank" class="external-link">@smetzer180</a>, Luke W. Johnston <a href="https://github.com/lwjohnst86" target="_blank" class="external-link">@lwjohnst86</a>,
and Lisa Rosenthal <a href="https://github.com/lisamr" target="_blank" class="external-link">@lisamr</a> for their helpful feedback for this vignette
and to Evgeni Chasnovski <a href="https://github.com/echasnovski" target="_blank" class="external-link">@echasnovski</a> for contributing the
<code><a href="../reference/geom_parallel_slopes.html">geom_parallel_slopes()</a></code> function via GitHub <a href="https://github.com/moderndive/moderndive/pull/55" target="_blank" class="external-link">pull request</a>. The authors do not have any financial
support to disclose.</p>
</div>
<div class="section level2">
<h2 class="unnumbered" id="references">References<a class="anchor" aria-label="anchor" href="#references"></a>
</h2>
<div id="refs" class="references csl-bib-body hanging-indent" entry-spacing="0">
<div id="ref-ASAGuidelines" class="csl-entry">
American Statistical Association Undergraduate Guidelines Workgroup.
2016. <span>“<span><span>‘Guidelines for Assessment and Instruction in
Statistics Education (GAISE) in Statistics Education (GAISE) College
Report College Report 2016’</span></span>.”</span> Alexandria, VA:
American Statistical Association.
</div>
<div id="ref-diez2015openintro" class="csl-entry">
Diez, D. M., C. D. Barr, and M. Çetinkaya-Rundel. 2015. <em>OpenIntro
Statistics</em>. OpenIntro, Incorporated. <a href="https://doi.org/10.5070/T573020084" class="external-link">https://doi.org/10.5070/T573020084</a>.
</div>
<div id="ref-ismay2019moderndive" class="csl-entry">
Ismay, Chester., and Albert Y. Kim. 2019. <em>Statistical Inference via
Data Science: A ModernDive into r and the Tidyverse</em>. Chapman &amp;
Hall/CRC the r Series. CRC Press. <a href="https://doi.org/10.1080/00224065.2020.1848366" class="external-link">https://doi.org/10.1080/00224065.2020.1848366</a>.
</div>
<div id="ref-R-tibble" class="csl-entry">
Müller, Kirill, and Hadley Wickham. 2019. <em>Tibble: Simple Data
Frames</em>. <a href="https://CRAN.R-project.org/package=tibble" class="external-link">https://CRAN.R-project.org/package=tibble</a>.
</div>
<div id="ref-R-broom" class="csl-entry">
Robinson, David, and Alex Hayes. 2019. <em>Broom: Convert Statistical
Analysis Objects into Tidy Tibbles</em>. <a href="https://CRAN.R-project.org/package=broom" class="external-link">https://CRAN.R-project.org/package=broom</a>.
</div>
<div id="ref-tidyverse2019" class="csl-entry">
Wickham, Hadley, Mara Averick, Jennifer Bryan, Winston Chang, Lucy
D’Agostino McGowan, Romain François, Garrett Grolemund, et al. 2019.
<span>“Welcome to the <span class="nocase">tidyverse</span>.”</span>
<em>Journal of Open Source Software</em> 4 (43): 1686. <a href="https://doi.org/10.21105/joss.01686" class="external-link">https://doi.org/10.21105/joss.01686</a>.
</div>
<div id="ref-R-ggplot2" class="csl-entry">
Wickham, Hadley, Winston Chang, Lionel Henry, Thomas Lin Pedersen,
Kohske Takahashi, Claus Wilke, Kara Woo, and Hiroaki Yutani. 2019.
<em><span class="nocase">ggplot2</span>: Create Elegant Data
Visualisations Using the Grammar of Graphics</em>. <a href="https://doi.org/10.1007/978-0-387-98141-3" class="external-link">https://doi.org/10.1007/978-0-387-98141-3</a>.
</div>
<div id="ref-R-dplyr" class="csl-entry">
Wickham, Hadley, Romain François, Lionel Henry, and Kirill Müller. 2020.
<em>Dplyr: A Grammar of Data Manipulation</em>. <a href="https://CRAN.R-project.org/package=dplyr" class="external-link">https://CRAN.R-project.org/package=dplyr</a>.
</div>
<div id="ref-R-knitr" class="csl-entry">
Xie, Yihui. 2020. <em>Knitr: A General-Purpose Package for Dynamic
Report Generation in r</em>. <a href="https://CRAN.R-project.org/package=knitr" class="external-link">https://CRAN.R-project.org/package=knitr</a>.
</div>
</div>
</div>
<div class="footnotes footnotes-end-of-document">
<hr>
<ol>
<li id="fn1"><p>For details on the remaining 5 variables, see the help
file by running <code><a href="../reference/evals.html">?evals</a></code>.<a href="#fnref1" class="footnote-back">↩︎</a></p></li>
<li id="fn2"><p>Note that <code>gender</code> was collected as a binary
variable at the time of the study (2005).<a href="#fnref2" class="footnote-back">↩︎</a></p></li>
<li id="fn3"><p>For more details on this dataset, see the help file by
running <code><a href="../reference/MA_schools.html">?MA_schools</a></code>.<a href="#fnref3" class="footnote-back">↩︎</a></p></li>
</ol>
</div>
  </div>

  <div class="col-md-3 hidden-xs hidden-sm" id="pkgdown-sidebar">

      </div>

</div>



      <footer><div class="copyright">
  <p></p>
<p>Developed by Albert Y. Kim, Chester Ismay.</p>
</div>

<div class="pkgdown">
  <p></p>
<p>Site built with <a href="https://pkgdown.r-lib.org/" class="external-link">pkgdown</a> 2.1.0.</p>
</div>

      </footer>
</div>






  </body>
</html>
